# 第 11.3 节 使用 pkgbase 更新

现在 FreeBSD 的系统更新与第三方软件更新的分离的（现在使用 freebsd-update），pkgbase 是目的就是将其合并起来统一使用 pkg 命令管理（学习 Linux）。但是现在只有一级架构的 RELEASE 才有 `freebsd-update` 可用。pkgbase 早在 2016 年就有了，原计划在 FreeBSD 14 就进入系统替代 `freebsd-update`，但是现在推迟到了 15。另外个人感觉 `freebsd-update` 体验非常差，非常慢（网络无关）。

**pkgbase 的设计初衷是为了让 stable、current 和 release（BETA、RC 等）都能使用一种二进制工具进行更新。当下，stable、current 只能通过完全编译源代码的方式来更新。**

目前不清楚是否让系统组件成为可选的部分（比如 cron、ntp 等第三方软件），这样就可以在 `bsdinstall` 安装的时候选择系统组件了。

## FreeBSD 官方镜像站

**存在风险，可能会丢失所有数据！**

以 FreeBSD 15.0-CURRENT 为例（当下仅支持 14 和 15）

创建文件夹：

```
# mkdir -p /usr/local/etc/pkg/repos/
```

编辑配置文件：

```
# ee /usr/local/etc/pkg/repos/FreeBSD-base.conf 
```

写入以下内容，保存退出：

```
FreeBSD-base: {
  url: "pkg+https://pkg.FreeBSD.org/${ABI}/base_release_0",
  enabled: yes
}
```

更新系统：

```shell-session
# pkg update 
# pkg install -r FreeBSD-base -g 'FreeBSD-*'
# find / -name \*.pkgsave -delete
# rm /boot/kernel/linker.hints
```

即可。

**存在风险，可能会丢失所有数据！**

## 参考文献

- [wiki/PkgBase](https://wiki.freebsd.org/PkgBase)

